<!DOCTYPE html>
<html>
<head>
<title>The Door</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
$(document).ready(function() {

	var socket = io();
	socket.on('connect', function(){
		
		socket.emit('lock_status');

	});	
	var lock_status;

	
	socket.on('lock_status', function(data){
		lock_status = data['status'];
		$("#lock_status").text(lock_status);
		if (lock_status=='locked'){
			$("#toggle_lock").html('unlock');
		}else if (lock_status=='unlocked'){
			$("#toggle_lock").html('lock');
		}
	});

	socket.on('toggle_lock', function(data){
		if (data['status']=='ok'){
			socket.emit('lock_status');
		}
	});

	$("#toggle_lock").click(function(){
		socket.emit('toggle_lock');
	});

	$(".body").ready(function(){
		reload_img();
	});	
 
	function reload_img() {
 		$('#mjpeg_img').attr('src', "http://localhost:8081/picam/cam_pic.php?time=" + new Date().getTime());
		setTimeout(reload_img, 100);
	}

});
</script>
</head>
<body>
	<h1><b><center>Smart Lock</center></b></h1><hr>


	<center><img id='mjpeg_img'></center>	<hr>
	<h2><center><span>LOCK STATUS:</span>	
	<span id='lock_status'></span></center></h2>

	<p><center><button id='toggle_lock'></button></center></p>
</body>
</html>
